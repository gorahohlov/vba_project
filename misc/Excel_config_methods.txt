ИСТОЧНИК: книга Джона Уокенбаха "Программирование в VBA Excel 2010"
---

Если в программе VBA необходимо вызвать функцию, которая определена в другой рабочей книге, задайте ссылку на другую рабочую книгу, воспользовавшись 
командой VBE `Tools -> References` (Сервис -> Ссылки).


НАДСТРОЙКИ

Функции рабочего листа, хранящиеся в надстройках, могут применяться в формулах без указания названия файла исходной рабочей книги.

Для упрощения доступа к функциям рабочего листа. Создаваемые пользователем функции рабочего листа, заданные в надстройке, не требуют указания имени рабочей книги перед вызовом.



## Использование в формуле рабочего листа

Применение специальных функций в формуле рабочего листа во многом подобно 
применению встроенных функций, за некоторым исключением. Удостоверьтесь, что 
Excel может найти необходимую функцию. Если функция сохранена в той же рабочей 
книге, то ничего особенного делать не нужно. Если же функция находится в другой рабочей книге, то необходимо указать Excel, где ее найти.

Вы вправе выбрать один из трех способов.

- Указать перед названием функции ссылку на файл. Например, если вы решили использовать функцию с названием CountNames, определенную в открытой 
рабочей книге Myfunc.xlsm, то обратитесь к следующей ссылке:
`=Myfuncs.xlsm!CountNames(Al:A1000)`
Если вы вставите функцию в диалоговом окне мастера функций (Insert Function), 
то ссылка на рабочую книгу будет добавлена автоматически.

- Установить ссылку на рабочую книгу. Это можно сделать с помощью команды 
VBE `Tools -> References` (Сервис -> Ссылки).

- Создать надстройку. При создании надстройки на основе рабочей книги, в которой 
представлены функции, можно не задавать ссылку на файл, если одна из функций 
используется в формуле. Однако надстройку необходимо устанавливать. Детально 
надстройки рассматриваются в главе 21.
